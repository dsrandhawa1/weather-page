<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Novi MI Weather & Travel</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html,body{
  margin:0;
  height:100%;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background: white;
}
.container{
  display:flex;
  flex-direction:column;
  height:100%;
  padding:10px;
  box-sizing:border-box;
}
.card{
border: .5px solid black;
  background:#EDEDED;
  border-radius:16px;
  padding:10px;
  box-shadow:0 4px 12px rgba(0,0,0,.08);
}
.top{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.city{
  font-size:2.4rem;
  font-weight:600;
}
.clock-wrap{
  text-align:right;
}
.date{
  font-size:2.2rem;
}
.clock{
  font-size:3.6rem;
  white-space:nowrap;
}
.clock-btn{
  font-size:0.9rem;
  padding:6px 10px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  background:#888888;
  color:#fff;
  margin-top:6px;
}
.current{
  display:flex;
  align-items:center;
  gap:24px;
  margin-top:16px;
}
.icon{
  font-size:4.5rem;
}
.temp{
  font-size:8.5rem;
  font-weight:600;
}
.hilo{
  display:flex;
  flex-direction:column;
  gap:10px;
}
.hilo-row{
  display:flex;
  gap:10px;
  align-items:baseline;
}
.hilo-label{
align-items: center;
  font-size:2.5rem;
  opacity:.6;
	
}
.hilo-value{
  font-size:2.8rem;
  font-weight:600;
}
.travel{
  font-size:1.15rem;
  color:#1a73e8;
}
.section{
  margin-top:16px;
}
.section-title{
  font-size:1.6rem;
  margin-bottom:8px;
}
.hourly,.daily{
  display:flex;
  justify-content:space-between;
}
.hour,.day{
  text-align:center;
  font-size:1.4rem;
}
.day-date{
  font-weight:600;
}
.updated{
  font-size:1rem;
  opacity:.6;
  margin-top:4px;
}
footer{
  margin-top:auto;
  text-align:center;
  opacity:.6;
}
</style>
</head>

<body>
<div style="border: 2px solid blue;" class="container">

  <div style="border: 2px solid blue;" class="card">
    <div style="border: 2px solid red;" class="current">


<table width=100%> <tr><td width=5%>
      <div style="border: 2px solid blue;" class="icon" id="icon">‚òÄÔ∏è</div>
</td><td width=15%>

      <div style="border: 2px solid blue;" class="temp" id="temp">--¬∞</div>

</rd>


<td>
      <div style="border: 2px solid blue;" class="hilo">
        <div style="border: 2px solid blue;" class="hilo-row">
          <div style="border: 2px solid blue;" class="hilo-label">High</div>
          <div style="border: 2px solid blue;" class="hilo-value" id="high">--¬∞</div>
        </div>
      </div>

        <div style="border: 2px solid blue;" class="hilo-row">
          <div style="border: 2px solid blue;" class="hilo-label">Low</div>
          <div style="border: 2px solid blue;" class="hilo-value" id="low">--¬∞</div>
        </div>
        <div style="border: 2px solid blue;" class="travel" id="travel"></div>

</td>


<td>
      <div style="border: 2px solid blue;" class="clock-wrap" style="align:right;border: 2px solid blue;">
        <div style="border: 2px solid blue;" class="date" id="dateLine"></div>
        <div style="border: 2px solid blue;" class="clock" id="clock"></div>
        <button class="clock-btn" onclick="toggleSeconds()" id="secBtn">
          Hide seconds
        </button>
      </div>

</td>
</tr>
</table>




    </div>

    <div style="border: 2px solid blue;" class="updated" id="updated"></div>
  </div>

  <div style="border: 2px solid blue;" class="card section">
    <div style="border: 2px solid blue;" class="section-title">Next 12 Hours</div>
    <div style="border: 2px solid blue;" class="hourly" id="hourly"></div>
  </div>

  <div style="border: 2px solid blue;" class="card section">
    <div style="border: 2px solid blue;" class="section-title">8-Day Forecast</div>
    <div style="border: 2px solid blue;" class="daily" id="daily"></div>
  </div>

  <footer>Powered by Dipu Singh</footer>
</div>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCdf0Y6MXleuEFpaBgX-TmCdap_UX_BeBM"></script>

<script>
const LAT = 42.4806;
const LON = -83.4755;
let showSeconds = true;

function toggleSeconds(){
  showSeconds = !showSeconds;
  document.getElementById("secBtn").textContent =
    showSeconds ? "Hide seconds" : "Show seconds";
  updateClock();
}

function updateClock(){
  const now = new Date();
  document.getElementById("dateLine").textContent =
    now.toLocaleDateString([], {weekday:"long", month:"long", day:"numeric", year:"numeric"});

  const opts = showSeconds
    ? {hour:"numeric",minute:"2-digit",second:"2-digit"}
    : {hour:"numeric",minute:"2-digit"};

  document.getElementById("clock").textContent =
    now.toLocaleTimeString([], opts);
}
setInterval(updateClock,1000);
updateClock();

function icon(code){
  if(code<3) return "‚òÄÔ∏è";
  if(code<50) return "‚õÖ";
  if(code<70) return "üåßÔ∏è";
  if(code<80) return "‚ùÑÔ∏è";
  return "üå©Ô∏è";
}

async function loadWeather(){
  const url = `https://api.open-meteo.com/v1/forecast?latitude=${LAT}&longitude=${LON}&current_weather=true&hourly=temperature_2m,weathercode&daily=temperature_2m_max,temperature_2m_min,weathercode&temperature_unit=fahrenheit&timezone=auto&forecast_days=10`;
  const r = await fetch(url);
  const d = await r.json();

  document.getElementById("temp").textContent =
    Math.round(d.current_weather.temperature)+"¬∞";
  document.getElementById("icon").textContent =
    icon(d.current_weather.weathercode);
  document.getElementById("high").textContent =
    Math.round(d.daily.temperature_2m_max[0])+"¬∞";
  document.getElementById("low").textContent =
    Math.round(d.daily.temperature_2m_min[0])+"¬∞";

  const h = document.getElementById("hourly");
  h.innerHTML="";
  const now = new Date();
  for(let i=0;i<d.hourly.time.length && h.children.length<12;i++){
    const t = new Date(d.hourly.time[i]);
    if(t>=now){
      h.innerHTML+=`
        <div style="border: 2px solid blue;" class="hour">
          <div style="border: 2px solid blue;">${t.toLocaleTimeString([], {hour:"numeric",hour12:true})}</div>
          <div style="border: 2px solid blue;">${icon(d.hourly.weathercode[i])}</div>
          <div style="border: 2px solid blue;">${Math.round(d.hourly.temperature_2m[i])}¬∞</div>
        </div>`;
    }
  }

  const day = document.getElementById("daily");
  day.innerHTML="";
  let shown=0;
  const today = new Date(); today.setHours(0,0,0,0);
  for(let i=0;i<d.daily.time.length && shown<8;i++){
    const dt = new Date(d.daily.time[i]);
    if(dt>today){
      day.innerHTML+=`
        <div style="border: 2px solid blue;" class="day">
          <div style="border: 2px solid blue;" class="day-date">
            ${dt.toLocaleDateString([], {weekday:"short", month:"numeric", day:"numeric"})}
          </div>
          <div style="border: 2px solid blue;">${icon(d.daily.weathercode[i])}</div>
          <div style="border: 2px solid blue;">${Math.round(d.daily.temperature_2m_max[i])}¬∞ /
               ${Math.round(d.daily.temperature_2m_min[i])}¬∞</div>
        </div>`;
      shown++;
    }
  }

  document.getElementById("updated").textContent =
    "Last updated: "+new Date().toLocaleTimeString([], {hour:"numeric",minute:"2-digit"});
}

function loadTravelTime(){
  const service = new google.maps.DistanceMatrixService();
  service.getDistanceMatrix({
    origins:["24010 Greening Dr, Novi, MI"],
    destinations:["1051 Oakland Ave, Birmingham, MI 48009"],
    travelMode:"DRIVING",
    drivingOptions:{ departureTime:new Date(), trafficModel:"bestguess" }
  }, (res,status)=>{
    if(status==="OK"){
      const e = res.rows[0].elements[0];
      document.getElementById("travel").textContent =
        `üöó Time to drive to Roeper School: ${e.duration_in_traffic.text}`;
    }
  });
}

loadWeather();
//loadTravelTime();
setInterval(loadWeather,300000);
//setInterval(loadTravelTime,300000);
</script>
</body>
</html>
