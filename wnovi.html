<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Novi MI Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html, body {
  margin:0;
  height:100%;
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  background:white;
}
.container{
  display:flex;
  flex-direction:column;
  height:100%;
  padding:12px;
  box-sizing:border-box;
}
.card{
  background:#ededed;
  border-radius:18px;
  padding:16px;
  box-shadow:0 4px 12px rgba(0,0,0,.1);
  margin-bottom:12px;
}
.top{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.city{
  font-size:2.5rem;
  font-weight:600;
}
.clock-wrap{
  text-align:right;
}
.date{font-size:2rem;}
.clock{font-size:3.6rem;}
.current{
  display:flex;
  align-items:center;
  gap:24px;
  margin-top:16px;
}
.icon{font-size:4.5rem;}
.temp{font-size:8rem;font-weight:600;}
.hilo{font-size:2.2rem;opacity:.7;}
.travel{
  margin-top:8px;
  font-size:1.15rem;
  color:#1a73e8;
}
.section{
  margin-top:16px;
}
.section-title{
  font-size:1.6rem;
  margin-bottom:8px;
}
.hourly,.daily{
  display:flex;
  justify-content:space-between;
}
.hour,.day{
  text-align:center;
  font-size:1.3rem;
}
.day-date{font-weight:600;}
.updated{
  margin-top:12px;
  display:flex;
  gap:16px;
  flex-wrap:wrap;
  font-size:1rem;
  opacity:.7;
}
.quote{font-style:italic;}
footer{
  margin-top:auto;
  text-align:center;
  opacity:.5;
}
</style>
</head>

<body>
<div  class="container">

  <!-- CURRENT WEATHER CARD -->

    <div class="card section"  >
<table width=100% >
<tr>
<td width=10% style="border: 2px solid black">
      <div  class="icon" id="icon">‚òÄÔ∏è</div>
</td>
<td width=15% style="border: 2px solid black">
      <div  class="temp" id="temp">--¬∞</div>
</td>
<td width=20% style="border: 2px solid black">
      <div  class="hilo">

		<table width=100% >
		<tr>
			<td align=right><div>High: </div></td>
			<td align=left><span id="high">--¬∞</span></td>
		</tr>
		<tr>
			<td align=right><div>Low: </div></td>
			<td align=left><span id="low">--¬∞</span></td>
		</tr>
		</table>



      </div>
</td>

<td width=40% align=center style="border: 2px solid black">

<table width=80% >
		<tr>
			<td align=right>    <div class="travel" id="travel"></div></td>
		</tr>
		<tr>
			<td align=right>&nbsp;</td>
		</tr>
		<tr>
			<td align=right>      <span class="quote" id="quote"></span></td>
		</tr>
		</table>
</td>


<td width=20% style="border: 2px solid black">
      <div  class="clock-wrap">
        <div  class="date" id="date"></div>
        <div  class="clock" id="clock"></div>
      </div>

</td>
</table>

  </div>
    <div  class="updated"><span id="updated"></span></div>

      


  <!-- HOURLY FORECAST -->
  <div  class="card section">
    <div  class="section-title">Next 12 Hours</div>
    <div  class="hourly" id="hourly"></div>
  </div>

  <!-- DAILY FORECAST -->
  <div  class="card section">
    <div  class="section-title">8-Day Forecast</div>
    <div  class="daily" id="daily"></div>
  </div>

</div>

<script>
const LAT = 42.4806;
const LON = -83.4755;

/* CLOCK */
function updateClock(){
  const now = new Date();
  document.getElementById("date").textContent =
    now.toLocaleDateString([], {weekday:"long",month:"long",day:"numeric",year:"numeric"});
  document.getElementById("clock").textContent =
    now.toLocaleTimeString([], {hour:"numeric",minute:"2-digit"});
}
setInterval(updateClock,1000);
updateClock();

/* WEATHER ICONS */
function weatherIcon(code){
  if(code<3) return "‚òÄÔ∏è";
  if(code<50) return "‚õÖ";
  if(code<70) return "üåßÔ∏è";
  if(code<80) return "‚ùÑÔ∏è";
  return "üå©Ô∏è";
}

/* LOAD WEATHER */
async function loadWeather(){
  const url =
    `https://api.open-meteo.com/v1/forecast?latitude=${LAT}&longitude=${LON}`+
    `&current_weather=true&hourly=temperature_2m,weathercode`+
    `&daily=temperature_2m_max,temperature_2m_min,weathercode`+
    `&temperature_unit=fahrenheit&timezone=auto`;

  const d = await (await fetch(url)).json();

  document.getElementById("temp").textContent = Math.round(d.current_weather.temperature)+"¬∞";
  document.getElementById("icon").textContent = weatherIcon(d.current_weather.weathercode);
  document.getElementById("high").textContent = Math.round(d.daily.temperature_2m_max[0])+"¬∞";
  document.getElementById("low").textContent = Math.round(d.daily.temperature_2m_min[0])+"¬∞";

  // 12-hour forecast
  const hourly = document.getElementById("hourly");
  hourly.innerHTML="";
  let shown=0;
  const now=new Date();
  for(let i=0;i<d.hourly.time.length && shown<12;i++){
    const t = new Date(d.hourly.time[i]);
    if(t>now){
      hourly.innerHTML += `
        <div  class="hour">
          <div>${t.toLocaleTimeString([], {hour:"numeric"})}</div>
          <div>${weatherIcon(d.hourly.weathercode[i])}</div>
          <div>${Math.round(d.hourly.temperature_2m[i])}¬∞</div>
        </div>`;
      shown++;
    }
  }

  document.getElementById("updated").textContent =
    "Last updated: "+new Date().toLocaleTimeString([], {hour:"numeric",minute:"2-digit"});


// 8-day forecast starting from tomorrow

const daily = document.getElementById("daily");
daily.innerHTML = "";
for (let i = 1; i <= 8; i++) { // skip today
  const [year, month, day] = d.daily.time[i].split("-").map(Number);
  const dt = new Date(year, month - 1, day); // correct local date
  daily.innerHTML += `
    <div class="day">
      <div class="day-date">
        ${dt.toLocaleDateString([], { weekday: "short", month: "numeric", day: "numeric" })}
      </div>
      <div>${weatherIcon(d.daily.weathercode[i])}</div>
      <div>${Math.round(d.daily.temperature_2m_max[i])}¬∞ /
           ${Math.round(d.daily.temperature_2m_min[i])}¬∞</div>
    </div>`;

}

}
loadWeather();
setInterval(loadWeather,300000);

/* LOAD QUOTE */
async function loadQuote(){
  try{
    const r = await fetch(
      "https://api.allorigins.win/raw?url="+
      encodeURIComponent("https://zenquotes.io/api/today")
    );
    const d = await r.json();
    document.getElementById("quote").textContent = `"${d[0].q}" ‚Äî ${d[0].a}`;
  }catch{
    document.getElementById("quote").textContent = "Stay present. Stay kind.";
  }
}
//loadQuote();

/* SCHOOL TRAVEL TIME USING MAPBOX (6 AM - 8 AM ONLY) */
const mapboxKey = "pk.eyJ1Ijoic3Rncm91cCIsImEiOiJjbWp4ZXE1cmE1a3VyM2dxMWVma2tkempzIn0.w225FCxMloOE30u-aghOmw"; // replace with your Mapbox token
const origin = [-83.4755,42.4806]; // Novi
const destination = [-83.2205,42.5536]; // Roeper School

async function loadTravelTime(){
  const now = new Date();
  const hour = now.getHours();
  const travelEl = document.getElementById("travel");

  if(hour >= 6 && hour < 8){
    // Only show travel time between 6AM and 8AM
    try{
      const url = `https://api.mapbox.com/directions/v5/mapbox/driving/`+
                  `${origin[0]},${origin[1]};${destination[0]},${destination[1]}`+
                  `?access_token=${mapboxKey}`;
      const r = await fetch(url);
      const d = await r.json();
      const minutes = Math.round(d.routes[0].duration / 60);
      travelEl.textContent = `üöó Estimated drive: ~${minutes} min`;
    }catch{
      travelEl.textContent = "üöó Travel time unavailable";
    }
  } else {
    travelEl.textContent = "üöó Travel time to Avleen school will be displayed only between 6‚ÄØAM and 8‚ÄØAM";
  }
}

// Initial load + interval every 10 minutes
//loadTravelTime();
//setInterval(loadTravelTime, 600000); // 600,000ms = 10 minutes
</script>
</body>
</html>





